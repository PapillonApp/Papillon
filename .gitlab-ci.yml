sync_from_github:
  image: alpine:latest

  rules:
    - if: '$CI_PIPELINE_SOURCE == "schedule"'

  before_script:
    - apk add --no-cache git
    - git config --global user.email "noreply@maelduret.com"
    - git config --global user.name "GitLab Sync Bot"

  script:
    - git remote remove github || true
    - git remote add github https://github.com/PapillonApp/Papillon.git
    - git fetch origin
    - git fetch github
    - git checkout -B main origin/main
    - git merge github/main --allow-unrelated-histories || true
    - git push "https://oauth2:${GITLAB_TOKEN}@${CI_SERVER_HOST}/${CI_PROJECT_PATH}.git" main
